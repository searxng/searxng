import{c as e,n as t,o as n,r,s as i}from"./searxng.core.min.js";import{t as a}from"./defineProperty.min.js";var o=class extends t{constructor(...e){super(...e),a(this,`name`,`infiniteScroll`)}async do(){let t=i(`results`).classList.contains(`only_template_images`),a=`article.result:last-child`,o=document.createElement(`div`);o.className=`loader`;let s=async i=>{let a=document.querySelector(`#search`);e(a);let s=document.querySelector(`#pagination form.next_page`);e(s);let c=a.getAttribute(`action`);if(!c)throw Error(`Form action not defined`);let l=document.querySelector(`#pagination`);e(l),l.replaceChildren(o);try{let e=await(await r(`POST`,c,{body:new FormData(s)})).text();if(!e)return;let n=new DOMParser().parseFromString(e,`text/html`),a=n.querySelectorAll(`#urls article`),o=n.querySelector(`#pagination`);document.querySelector(`#pagination`)?.remove();let l=document.querySelector(`#urls`);if(!l)throw Error(`URLs element not found`);a.length>0&&!t&&l.appendChild(document.createElement(`hr`)),l.append(...Array.from(a)),o&&(document.querySelector(`#results`)?.appendChild(o),i())}catch(e){console.error(`Error loading next page:`,e);let t=Object.assign(document.createElement(`div`),{textContent:n.translations?.error_loading_next_page??`Error loading next page`,className:`dialog-error`});t.setAttribute(`role`,`alert`),document.querySelector(`#pagination`)?.replaceChildren(t)}},c=new IntersectionObserver(e=>{let[t]=e;t?.isIntersecting&&(c.unobserve(t.target),s(()=>{let e=document.querySelector(a);e&&c.observe(e)}).then(()=>{}))},{rootMargin:`320px`}),l=document.querySelector(a);l&&c.observe(l)}};export{o as default};
//# sourceMappingURL=InfiniteScrollPlugin.min.js.map